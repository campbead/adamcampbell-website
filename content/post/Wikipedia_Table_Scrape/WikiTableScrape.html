---
title: "Scraping Wikpedia Tables"
author: "Adam J Campbell"
date: 2020-06-23
output: html_document
draft: True
summary: A quick how-to guide on scraping tables from wikipedia, using R.
---



<p>I was recently attempting to scrape a table from <a href="https://en.wikipedia.org/wiki/Main_Page">Wikipedia</a>. I wanted something very quick since I was responding to a group chat and wanted to make a quick histogram (something I love about R and ggplot). I came across this tweet from <a href="https://twitter.com/juliasilge">Julia Silge</a>:</p>
{{% tweet "951639629182074880" %}}
<p>However there are two problems with this</p>
<ol style="list-style-type: decimal">
<li>the tag for table has changed. and it may change in the future since Wikipedia a living document.</li>
<li>if you want to use this on other tables in Wikipedia, it’s not entirely obvious, what you need to change.</li>
</ol>
<p>Problem 1 was address by <a href="https://twitter.com/TheBishop">David Bishop</a> in this tweet:
{{% tweet "1024040452230664192" %}}</p>
<p>For problem 2, I’ll show you how to change the above code into a code to scrape the table I was interested in, which was the <a href="https://en.wikipedia.org/wiki/List_of_rallies_for_the_2016_Donald_Trump_presidential_campaign">attendance size of Trump’s rallies</a>. Here, I’d like to scrape the <code>Primary rallies (June 2015–June 2016)</code> table.</p>
<p>The first thing to change is the <code>read_html()</code> line:</p>
<p><code>read_html("https://en.wikipedia.org/wiki/Current_members_of_the_United_States_House_of_Representatives")</code></p>
<p>all we need to here is update the hyperlink:</p>
<p><code>read_html("https://en.wikipedia.org/wiki/List_of_rallies_for_the_2016_Donald_Trump_presidential_campaign")</code></p>
<p>The next thing you’ll have to change is the <code>html_node()</code> line. To this this you’ll have to know the tag of the table in the html code. To find this you’ll have to <a href="https://www.lifewire.com/get-inspect-element-tool-for-browser-756549">inspect the html code</a> of the wikipedia page you’re looking at.</p>
<p>Inspect the table you’re interested in and you’ll see a line starting <code>&lt;table class= ...</code>
Right click on that line and select <code>Copy</code> -&gt; <code>CSS Selector</code></p>
<p>In my case this returns:
<code>table.wikitable:nth-child(17)</code></p>
<p>You can then update the <code>html_node</code> line by c</p>
<pre class="r"><code>library(tidyverse)
library(rvest)
h &lt;- read_html(&quot;https://en.wikipedia.org/wiki/List_of_rallies_for_the_2016_Donald_Trump_presidential_campaign&quot;)

rallies &lt;- h %&gt;%
    html_node(&quot;#mw-content-text &gt; div &gt; table:nth-child(17)&quot;) %&gt;%
    #html_node(&quot;table#votingmembers&quot;) %&gt;%
    html_table()</code></pre>
