---
title: What is the population density of New Zealand?
author: Adam J Campbell
date: 2020-05-20
output: html_document
draft: True
summary: Population density is easy to calculate, but sometimes misleading.  Is there a better way?
---

Recently, it has been argued that New Zealand's success with dealing with Covid-19 has been due, in part, to its low population density with around 17.7 people per square kilometer.  If this population density were compared to US states, then New Zealand would down rank toward the bottom in terms of population density.  However population density, as it is normally calculated is not necessarily the best representation of how packed or densely people live in a region, state, or nation.

## Pinksvile and Bluetopia

Let's start by considering two hypothetical cities: Pinksville and Bluetopia.  Both cities are exactly 25 square-kilometers in area, and both cites have 25 residents.  Therefore with a traditional measure of population density, where the total population is divided by the total area, these cities and indistinguishable.  However, if you take a closer look at figure below you'll notice these cities are quite different in their population structure.  

![](/img/popdensity.png)





```{r echo=FALSE, message=FALSE, warning=FALSE}
library(reactable)
library(htmltools)
library(dplyr)


state_density <- readRDS(file="state_density.Rda")

# remove DC and PR
state_density <- state_density %>%
  filter(!STATE %in% c("Puerto Rico","District of Columbia"))


bar_chart <- function(label, width = "100%", height = "16px", fill = "#3fc1c9", background = NULL) {
  bar <- div(style = list(background = fill, width = width, height = height))
  chart <- div(style = list(flexGrow = 1, marginLeft = "16px", background = background), bar)
  format_label <- div(style = list(width = "40px"), format(round(label, digits = 1), nsmall = 1) )
  div(style = list(display = "flex", alignItems = "center", justifyContent = "flex-end"), format_label, chart)
}

reactable(
  state_density,
  pagination = FALSE,
  defaultSorted = "lived_density", 
  defaultColDef = colDef(align = "left", 
                         defaultSortOrder = "desc", 
                         style = list(fontFamily = "Fira Mono, Consolas,                                                         Monaco, monospace",
                                      fontSize = "13.5px",
                                      whiteSpace = "pre",
                                      color = "black"),
                         ),
  
  columns = list(
    STATE = colDef(
      name = "REGION",
      align = "left",
      width = 120,
      headerStyle = list(color = "black"),
      style = list(fontFamily = "Karla, Helvetica Neue, Helvetica, Arial, sans-serif", 
                    fontSize = "13.5px",
                    whiteSpace = "pre",
                   color = "black"),
      defaultSortOrder = "asc"

    ),
    state_pop = colDef(
      name = "POPULATION",
      align = "right", 
      headerStyle = list(color = "black"),
      format = colFormat(digits = 0, separators = TRUE)
     

    ),
    state_land_area = colDef(
      name = "AREA",
      align = "right",
      style = list(width = "50px" ,
                   fontFamily = "Fira Mono, Consolas, Monaco, monospace", 
                   fontSize = "13.5px",
                   whiteSpace = "pre",
                   paddingRight = "30px",
                   color = "black"),
      headerStyle = list(paddingRight = "30px",color = "black"),
     
      format = colFormat(digits = 0, separators = TRUE)
      

    ),
    population_density_land = colDef(
      name = "POPULATION DENSITY",
      format = colFormat(digits = 1, separators = TRUE),
      align = "right", 
      style = list(width = "50px" ,
                   fontFamily = "Fira Mono, Consolas, Monaco, monospace",
                   fontSize = "13.5px",
                   whiteSpace = "pre",
                   color = "black"),
      #minWidth = 150,
      headerStyle = list(textAlign = "left", color = "black"),
      cell = function(value) {
        width <- paste0(value / max(state_density$population_density_land) * 100, "%")
        bar_chart(value, width = width, fill = "#fc5185") }

    ),
    lived_density = colDef(
      name = "LIVED DENSITY",
      align = "right", 
      headerStyle = list(textAlign = "left", color = "black"),
      format = colFormat(digits = 0, separators = TRUE),
      cell = function(value) {
        
        width <- paste0(value / max(state_density$lived_density) * 100, "%")
        bar_chart(value, width = width) 
        
        }

    ),
    density_ratio = colDef(
      name = "RATIO",
      align = "right", 
      width = 60,
      headerStyle = list(color = "black"),
      format = colFormat(digits = 1, separators = TRUE),
      style = list(fontFamily = "Fira Mono, Consolas, Monaco, monospace",
                   fontSize = "13.5px",
                   whiteSpace = "pre",
                   color = "black"),
      defaultSortOrder = "desc"


    )
  ),
  theme = reactableTheme(
    borderColor = "#dfe2e5",
    stripedColor = "#f6f8fa",
    highlightColor = "#f0f5f9",
    cellPadding = "8px 12px",
    style = list(fontFamily = "Karla, Helvetica Neue, Helvetica, Arial, sans-serif",
                 margin = "0px auto auto auto",
                 fontSize = "13px",
                 width = "720px"),
    searchInputStyle = list(width = "100%")
  ),
  highlight = TRUE,
  compact = TRUE,
  showSortIcon = FALSE
)


```
